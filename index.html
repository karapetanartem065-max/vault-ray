<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>VAULT RAY</title>
    <script src="https://telegram.org"></script>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        /* Блокируем всё лишнее на уровне системы */
        * {
            touch-action: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000;
            color: #00f2ff;
            font-family: 'Orbitron', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            overflow: hidden;
        }

        #score {
            font-size: 5rem;
            text-shadow: 0 0 30px #00f2ff;
            pointer-events: none;
        }

        /* Кристалл теперь — это анимированный контейнер */
        .crystal-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .crystal-shape {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #00f2ff 0%, #0044ff 100%);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            box-shadow: 0 0 60px rgba(0, 242, 255, 0.6);
            animation: rotate 10s infinite linear;
            pointer-events: none; /* Клик проходит СКВОЗЬ него на подложку */
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Зона клика на весь экран */
        #click-zone {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10;
        }

        .tap-num {
            position: absolute;
            color: #fff;
            font-size: 2.5rem;
            font-weight: bold;
            pointer-events: none;
            z-index: 20;
            animation: fly 0.5s ease-out forwards;
        }

        @keyframes fly {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-150px) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="score">0</div>

    <div class="crystal-container">
        <div class="crystal-shape"></div>
    </div>

    <div id="click-zone"></div>

    <div style="width: 80%; height: 10px; background: #222; border-radius: 5px;">
        <div style="width: 75%; height: 100%; background: #00f2ff; box-shadow: 0 0 15px #00f2ff;"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        let count = 0;
        const scoreDisp = document.getElementById('score');
        const zone = document.getElementById('click-zone');

        // Глобальная функция тапа
        function handleTap(e) {
            e.preventDefault();
            
            // Считаем каждый палец отдельно (мультитап)
            const touches = e.changedTouches ? e.changedTouches : [e];
            
            for (let i = 0; i < touches.length; i++) {
                count++;
                scoreDisp.innerText = count;

                // Вибрация — ТГ должен ее почувствовать
                tg.HapticFeedback.impactOccurred('heavy');

                // Создаем цифру
                const t = touches[i];
                const n = document.createElement('div');
                n.className = 'tap-num';
                n.innerText = '+1';
                n.style.left = (t.clientX || t.pageX) + 'px';
                n.style.top = (t.clientY || t.pageY) + 'px';
                document.body.appendChild(n);
                setTimeout(() => n.remove(), 500);
            }
        }
        // Вешаем события на прозрачную зону поверх всего
        zone.addEventListener('touchstart', handleTap, {passive: false});
        zone.addEventListener('mousedown', handleTap);
    </script>
</body>
</html>

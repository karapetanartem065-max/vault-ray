<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VAULT RAY</title>
    <script src="https://telegram.org"></script>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        body {
            background-color: #050505;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            margin: 0; height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: space-around;
            overflow: hidden; touch-action: manipulation;
        }

        .header { text-align: center; }
        .score { font-family: 'Orbitron', sans-serif; font-size: 4rem; color: #00f2ff; text-shadow: 0 0 20px #00f2ff; }

        /* Реальный SVG Кристалл */
        #crystal-container {
            width: 280px; height: 280px;
            cursor: pointer;
            transition: transform 0.05s ease;
            -webkit-tap-highlight-color: transparent;
        }

        #crystal-container:active { transform: scale(0.92); }

        .footer { width: 85%; }
        .energy-bar { width: 100%; height: 10px; background: #1a1a1a; border-radius: 10px; border: 1px solid #333; overflow: hidden; }
        .fill { width: 75%; height: 100%; background: #00f2ff; box-shadow: 0 0 15px #00f2ff; }

        /* Анимация цифр */
        .tap-number {
            position: absolute; color: white; font-family: 'Orbitron'; font-size: 32px;
            pointer-events: none; animation: fly 0.6s forwards;
        }
        @keyframes fly { to { transform: translateY(-150px); opacity: 0; } }
    </style>
</head>
<body>

    <div class="header">
        <div style="font-size: 12px; letter-spacing: 2px; color: #444;">BALANCE</div>
        <div class="score" id="score">0</div>
    </div>

    <!-- Вставляем кристалл как SVG, чтобы он точно не был прямоугольником -->
    <div id="crystal-container">
        <svg viewBox="0 0 100 100" style="width: 100%; height: 100%; filter: drop-shadow(0 0 15px #00f2ff);">
            <polygon points="50,5 95,25 95,75 50,95 5,75 5,25" fill="url(#grad)" stroke="#00f2ff" stroke-width="1""")/>>
            <defs>
                <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#00f2ff;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#0044ff;stop-opacity:1" />
                </linearGradient>
            </defs>
        </svg>
    </div>

    <div class="footer">
        <div class="energy-bar"><div class="fill"></div></div>
        <div style="text-align: center; margin-top: 10px; font-family: 'Orbitron'; color: #666; font-size: 12px;">ENERGY: 750/1000</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const container = document.getElementById('crystal-container');
        const scoreDisp = document.getElementById('score');
        let count = 0;

        // Универсальный обработчик (и для мышки, и для тача)
        const doTap = (e) => {
            e.preventDefault();
            count++;
            scoreDisp.innerText = count;

            // Вибрация
            tg.HapticFeedback.impactOccurred('medium');

            // Вылет цифры
            const x = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const y = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
            
            const n = document.createElement('div');
            n.className = 'tap-number';
            n.innerText = '+1';
            n.style.left = x + 'px';
            n.style.top = y + 'px';
            document.body.appendChild(n);
            setTimeout(() => n.remove(), 600);
        };

        container.addEventListener('touchstart', doTap);
        container.addEventListener('mousedown', doTap);
    </script>
</body>
</html>
